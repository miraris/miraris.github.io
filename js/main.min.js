'use strict';var _createClass=function(){function a(b,c){for(var f,d=0;d<c.length;d++)f=c[d],f.enumerable=f.enumerable||!1,f.configurable=!0,'value'in f&&(f.writable=!0),Object.defineProperty(b,f.key,f)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError('Cannot call a class as a function')}for(var el,range=60+Math.floor(Math.random()*Math.floor(180)),links=document.getElementsByClassName('link'),i=0;i<links.length;i++)el=links[i],el.style.color='hsl('+(range+range/(i+2))+', 100%, 20%)';var canvas=document.getElementById('mainCanvas'),ctx=canvas.getContext('2d'),chunk=function(a,b){for(var c=[],d=0,f=a.length;d<f;d+=b)c.push(a.slice(d,d+b));return c},findMax=function(a){for(var b=a[0][0],c=a[0][1],d=a.length,f=1;f<d;f++){var g=a[f][0],h=a[f][1];b=g>b?g:b,c=h>c?h:c}return[b,c]},API_URL='https://api.miraris.moe',getImage=function(){return fetch(API_URL).then(function(a){return a.json()})},Sketcher=function(){function a(b){_classCallCheck(this,a);var c=JSON.parse(b);this.data=c,this.coords=[],this.state={current:0,max:0,lightness:50,opacity:0.4}}return _createClass(a,[{key:'clear',value:function clear(){this.state.current=0,ctx.clearRect(0,0,canvas.width,canvas.height)}},{key:'resize',value:function resize(){var _state$size=this.state.size,b=_state$size.width,c=_state$size.height;this.state.maxs=findMax(this.data);var d=b/2-this.state.maxs[0]/2,f=c/2-this.state.maxs[1]/2;return chunk(this.data.map(function(g){return[g[0]+d,g[1]+f]}),this.data.length/500)}},{key:'setSize',value:function setSize(b){this.state.size=b,this.coords=this.resize(),this.state.max=this.coords.length}},{key:'draw',value:function draw(){var m=this;if(!(this.state.current>=this.state.max)){for(var _state=this.state,b=_state.current,c=_state.size,d=_state.lightness,f=_state.opacity,g=this.coords[b],h=0;h<g.length;h++){var k=g[h],l={h:k[0]/this.state.maxs[0]*range,s:100-100*(k[1]/c.height),l:d};ctx.fillStyle='hsla('+l.h+', '+l.s+'%, '+l.l+'%, '+f+')',ctx.fillRect(k[0],k[1],1,1)}this.state.current++,requestAnimationFrame(function(){return m.draw()})}}}]),a}(),resizeCanvas=function(a){var b={width:window.innerWidth,height:window.innerHeight};canvas.width=b.width,canvas.height=b.height,a.setSize(b),a.clear(),a.draw()};getImage().then(function(a){var b=a[0].data,c=new Sketcher(b),d=new CustomEvent('customResize',{detail:c});window.addEventListener('customResize',function(f){return resizeCanvas(f.detail)}),window.addEventListener('resize',function(){return window.dispatchEvent(d)}),resizeCanvas(c)});